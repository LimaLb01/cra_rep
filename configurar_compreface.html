<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurar CompreFace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-2xl mx-auto">
            <h1 class="text-4xl font-bold mb-8 text-center">‚öôÔ∏è Configurar CompreFace</h1>
            
            <!-- Status -->
            <div id="status" class="mb-6 p-4 rounded-lg bg-gray-800">
                <div class="flex items-center">
                    <span class="material-icons mr-2">sync</span>
                    <span>Verificando configura√ß√£o...</span>
                </div>
            </div>

            <!-- Configura√ß√µes -->
            <div class="bg-gray-800 rounded-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4">üîß Configura√ß√µes</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">URL do CompreFace</label>
                        <input type="text" id="baseUrl" 
                               value="http://localhost:8000"
                               class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Nome da Aplica√ß√£o</label>
                        <input type="text" id="appName" 
                               value="Sistema RandonCorp"
                               class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <button onclick="configurarCompreFace()" 
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                        <span class="material-icons mr-2">settings</span>
                        Configurar CompreFace
                    </button>
                </div>
            </div>

            <!-- Resultado -->
            <div id="resultado" class="bg-gray-800 rounded-lg p-6 mb-6 hidden">
                <h3 class="text-xl font-bold mb-4">üìã Resultado da Configura√ß√£o</h3>
                <div id="resultadoContent" class="space-y-2"></div>
            </div>

            <!-- Logs -->
            <div class="bg-gray-800 rounded-lg p-6">
                <h3 class="text-xl font-bold mb-4 flex items-center">
                    <span class="material-icons mr-2">terminal</span>
                    Logs
                </h3>
                <div id="logs" class="bg-black rounded-lg p-4 h-48 overflow-y-auto font-mono text-sm">
                    <div class="text-green-400">Sistema iniciado...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class CompreFaceConfigurator {
            constructor() {
                this.baseUrl = 'http://localhost:8000';
                this.init();
            }

            init() {
                this.log('üîß Inicializando configurador do CompreFace...');
                this.verificarStatus();
            }

            log(message, type = 'info') {
                const logs = document.getElementById('logs');
                const timestamp = new Date().toLocaleTimeString();
                const color = type === 'success' ? 'text-green-400' : type === 'error' ? 'text-red-400' : type === 'warning' ? 'text-yellow-400' : 'text-gray-400';
                logs.innerHTML += `<div class="${color}">[${timestamp}] ${message}</div>`;
                logs.scrollTop = logs.scrollHeight;
            }

            updateStatus(type, message) {
                const status = document.getElementById('status');
                const icon = status.querySelector('.material-icons');
                const text = status.querySelector('span:last-child');
                
                status.className = `mb-6 p-4 rounded-lg ${type === 'success' ? 'bg-green-800' : type === 'error' ? 'bg-red-800' : 'bg-yellow-800'}`;
                icon.textContent = type === 'success' ? 'check_circle' : type === 'error' ? 'error' : 'warning';
                text.textContent = message;
            }

            async verificarStatus() {
                try {
                    this.log('üîç Verificando status do CompreFace...');
                    
                    // Tentar acessar a interface web
                    const response = await fetch(`${this.baseUrl}/`, {
                        method: 'GET',
                        mode: 'no-cors' // Para evitar CORS
                    });
                    
                    this.log('‚úÖ CompreFace est√° rodando!', 'success');
                    this.updateStatus('success', '‚úÖ CompreFace est√° rodando');
                    
                } catch (error) {
                    this.log(`‚ùå Erro ao verificar status: ${error.message}`, 'error');
                    this.updateStatus('error', '‚ùå CompreFace n√£o est√° acess√≠vel');
                }
            }

            async configurarCompreFace() {
                this.baseUrl = document.getElementById('baseUrl').value;
                const appName = document.getElementById('appName').value;
                
                this.log(`üîß Configurando CompreFace: ${appName}`);
                this.updateStatus('warning', 'Configurando...');
                
                try {
                    // Passo 1: Verificar se a interface est√° acess√≠vel
                    this.log('üìã Passo 1: Verificando interface web...');
                    
                    // Abrir interface web em nova aba
                    window.open(`${this.baseUrl}`, '_blank');
                    
                    this.log('‚úÖ Interface web aberta!', 'success');
                    this.log('üìã Instru√ß√µes:', 'info');
                    this.log('1. Crie uma conta de administrador', 'info');
                    this.log('2. Fa√ßa login na interface', 'info');
                    this.log('3. V√° para "Applications"', 'info');
                    this.log('4. Clique em "Add Application"', 'info');
                    this.log('5. Configure:', 'info');
                    this.log(`   - Name: ${appName}`, 'info');
                    this.log('   - Type: Recognition', 'info');
                    this.log('   - Status: Active', 'info');
                    this.log('6. Copie a API Key gerada', 'info');
                    this.log('7. Use a API Key nos outros arquivos', 'info');
                    
                    this.updateStatus('success', '‚úÖ Instru√ß√µes exibidas - Siga os passos na interface web');
                    
                    // Mostrar resultado
                    document.getElementById('resultado').classList.remove('hidden');
                    document.getElementById('resultadoContent').innerHTML = `
                        <div class="text-green-400">‚úÖ Interface web aberta!</div>
                        <div class="text-yellow-400">üìã Siga as instru√ß√µes na interface web</div>
                        <div class="text-blue-400">üîó URL: ${this.baseUrl}</div>
                        <div class="text-gray-400">üìù Nome da aplica√ß√£o: ${appName}</div>
                    `;
                    
                } catch (error) {
                    this.log(`‚ùå Erro na configura√ß√£o: ${error.message}`, 'error');
                    this.updateStatus('error', '‚ùå Erro na configura√ß√£o');
                }
            }
        }

        // Instanciar o configurador
        const configurator = new CompreFaceConfigurator();

        // Fun√ß√£o global
        function configurarCompreFace() {
            configurator.configurarCompreFace();
        }
    </script>
</body>
</html>
